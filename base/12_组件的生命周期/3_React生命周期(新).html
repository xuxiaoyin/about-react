<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
  <div id="test"></div>

  <script src="../js/17.0.2/react.development.js"></script>
  <script src="../js/17.0.2/react-dom.development.js"></script>
  <script src="../js/babel.min.js"></script>

 <script type="text/babel">
   /**
    * 1.初始化阶段：由ReactDom.render()触发---初次渲染
    *     1.constructor()
    *     2.componentWillMount()
    *     3.render()
    *     4.componentDidMount()
    * 2.更新阶段：由组件内部this.setState()或父组件重新render触发
    *     1.shouldComponentUpdate()
    *     2.componentWillMount()
    *     3.render()
    *     4.componentDidUpdate()
    * 3.卸载组件：由ReactDOM.unmountComponentAtNode()触发
    *     1.componentWillUnmount()
    */
   class Count extends React.Component{
     constructor() {
       console.log('constructor')
       super()
       this.state = { count: 0 }
     }

     // 从props获取派生的状态
     // 当组件中的state完全取决于：外部传来的props时，就要用该钩子,基本不用
     // static getDerivedStateFromProps(props, state) {
     //   console.log(props)
     //   console.log(state)
     //   console.log('getDerivedStateFromProps')
     //   return {count: props.a}
     // }

     getSnapshotBeforeUpdate() {
       console.log('getSnapshotBeforeUpdate')
       return '我是一些数据'
     }

     componentDidUpdate(prevProps, prevState, snapshotValue) {
       console.log(prevProps)
       console.log(prevState)
       console.log(snapshotValue)
       console.log('componentDidUpdate')
     }

     // 加法回调函数
     add = () => {
       const { count } = this.state
       this.setState({count: count+1})
     }

     death = () => {
       ReactDOM.unmountComponentAtNode(document.getElementById('test'))
     }

     // 强制更新
     mustUpdate = () => {
       this.forceUpdate()
     }

     render() {
       console.log(this)
       console.log('render')
      return (
          <div>
            <h1>当前求和：{this.state.count}</h1>
            <button onClick={this.add}>点我+1</button>
            <button onClick={this.death}>点我卸载组件</button>
            <button onClick={this.mustUpdate}>不加不减，就是强制掉一下render</button>
          </div>
      )
     }
   }

   ReactDOM.render(<Count a={8} />, document.getElementById('test'))
 </script>
</body>
</html>
